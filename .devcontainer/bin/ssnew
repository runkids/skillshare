#!/usr/bin/env bash
set -euo pipefail

name=""
if [[ $# -gt 0 && "$1" != "--" ]]; then
  name="$1"
  shift
fi
if [ -z "$name" ]; then
  name="env-$(date +%Y%m%d-%H%M%S)"
fi
if [ "${1:-}" = "--" ]; then
  shift
fi

ssenv create "$name"
if [ "$#" -gt 0 ]; then
  exec ssenv enter "$name" -- "$@"
fi
exec ssenv enter "$name"
